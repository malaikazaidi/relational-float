#lang racket
(require "numbers.rkt" "mk-float-base.rkt")
(provide (all-defined-out))
                

;defined some fp-numbers for testing
(define epsilon `(0 ,(build-num 1) ,(append (make-list 15 0) (list 1))))

(define zero `(0 ,(build-num 0) ,(make-list 16 0)))
(define one `(0 ,(build-num 127) ,(append (make-list 15 0) '(1))))
(define two `(0 (0 0 0 0 0 0 0 1) ,(append (make-list 15 0) '(1))))
(define ntwo `(1 (0 0 0 0 0 0 0 1) ,(append (make-list 15 0) '(1))))
(define negone `(1 ,(build-num 127) ,(append (make-list 15 0) '(1))))
(define smallnorm `(0 ,(build-num 1) ,(make-list 15 0)))
(define largenorm `(0 ,(build-num 254) ,(make-list 15 1)))
(define four `(0 ,(build-num 129) ,(append (make-list 15 0) '(1))))
(define negfour `(1 ,(build-num 129) ,(append (make-list 15 0) '(1))))
(define seventytwo `(0 ,(build-num 133) (0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1)))
(define nseventytwo `(1 ,(build-num 133) ( 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1)))
(define neg421 `(1 ,(build-num 135) ( 0 0 0 0 0 0 0 1 0 1 0 0 1 0 1 1)))
(define negseventy `(1 ,(build-num 133) (0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 1)))
(define seventy `(0 ,(build-num 133) ( 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 1)))
(define fortytwo `(0 ,(build-num 132) ( 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 1)))
(define nfortytwo `(1 ,(build-num 132) (0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 1)))
(define sixty `(0 ,(build-num 132) ( 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1)))
(define p2049 `(0 ,(build-num 138) ( 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1)))
(define three `(0 ,(build-num 128) (0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1)))
(define nthree `(1 ,(build-num 128) (0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1)))
(define p12.8 `(0 ,(build-num 130) ( 0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1)))
(define p12.5 `(0 ,(build-num 130) ( 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1)))
(define n45.2 `(1 ,(build-num 132) ( 0 0 1 1 0 0 1 1 0 0 1 0 1 1 0 1)))
(define n45.125 `(1 ,(build-num 132) ( 0 0 0 0 0 0 0 1 0 0 1 0 1 1 0 1)))
(define n1020.625 `(1 ,(build-num 136) ( 0 0 0 1 0 1 0 0 1 1 1 1 1 1 1 1)))
(define p0.636018991 `(0 ,(build-num 126) ( 0 1 0 0 1 0 1 1 0 1 0 0 0 1 0 1))) ; This number was NOT the result of TRUNCATED ROUNDING
(define psmallestd `(0 ,(build-num 0) (1)))
(define plargestd `(0 ,(build-num 0) ,(append (make-list 15 1) '(1)))); 2^-126 * (1-2^(-23))
(define underf `(0 ,(build-num 103) ,(append (make-list 15 0) '(1)) ))
(define p2^23 `(0 ,(build-num 104) ,(append (make-list 15 0) '(1))))
(define pinf `(0 (1 1 1 1 1 1 1 1) ,(append (make-list 15 0) '(1))))
(define ninf `(1 (1 1 1 1 1 1 1 1) ,(append (make-list 15 0) '(1))))
(define qnan `(0 (1 1 1 1 1 1 1 1) ( 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1))); Only most sig bit is important for distinguishing nans
(define snan `(0 (1 1 1 1 1 1 1 1) ( 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1)))
(define p46 `(0 ,(build-num 132) ( 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 1)))
(define p132 `(0 ,(build-num 134) (0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1)))
(define n5 `(1 ,(build-num 129) ( 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1)))
(define n74 `(1 ,(build-num 133) (0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 1)))
(define n422 `(1 ,(build-num 135) ( 0 0 0 0 0 0 0 0 1 1 0 0 1 0 1 1)))
(define n38 `(1 ,(build-num 132) ( 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 1)))
(define p38 `(0 ,(build-num 132) ( 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 1)))
(define n12 `(1 ,(build-num 130) ( 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1)))
(define n420 `(1 ,(build-num 135) ( 0 0 0 0 0 0 0 0 0 1 0 0 1 0 1 1)))
(define p5.5 (build-truncated-float-helper 5.5 PRECISION))
(define n5.5 (build-truncated-float-helper -5.5 PRECISION))
(define p4.5 (build-truncated-float-helper 4.5 PRECISION))
(define p4.6 (build-truncated-float-helper 4.6 PRECISION))
(define p2.5 (build-truncated-float-helper 2.5 PRECISION))
(define n2.5 (build-truncated-float-helper -2.5 PRECISION))
(define n2.25 (build-truncated-float-helper -2.25 PRECISION))
(define p2.25 (build-truncated-float-helper 2.25 PRECISION))
(define p5.75 (build-truncated-float-helper 5.75 PRECISION))
(define p3.25 (build-truncated-float-helper 3.25 PRECISION))
(define n3.25 (build-truncated-float-helper -3.25 PRECISION))
(define p4.2825 (build-truncated-float-helper 4.2825 PRECISION))
(define p1.05 (build-truncated-float-helper 1.05 PRECISION))
(define p3.2325 (build-truncated-float-helper 3.2325 PRECISION))
(define n23.245 (build-truncated-float-helper -23.245 PRECISION))
(define n10.12  (build-truncated-float-helper -10.12 PRECISION))
(define n31.5 (build-truncated-float-helper -31.5 PRECISION))
(define n33.365 (build-truncated-float-helper -33.365 PRECISION))
(define n9 (build-truncated-float-helper -9 PRECISION))
(define p9 (build-truncated-float-helper 9 PRECISION))
(define p168 (build-truncated-float-helper 168 PRECISION))
(define n168 (build-truncated-float-helper -168 PRECISION))
(define n7 (build-truncated-float-helper -7 PRECISION))
(define p7.5 (build-truncated-float-helper 7.5 PRECISION))
(define n13 (build-truncated-float-helper -13 PRECISION))
(define p4320 (build-truncated-float-helper 4320 PRECISION))
(define n4320 (build-truncated-float-helper -4320 PRECISION))
(define p280 (build-truncated-float-helper 280 PRECISION))
(define p421 (build-truncated-float-helper 421 PRECISION))
(define p6 (build-truncated-float-helper 6 PRECISION))
(define n6 (build-truncated-float-helper -6 PRECISION))
(define p8.125 (build-truncated-float-helper 8.125 PRECISION))
(define n8.125 (build-truncated-float-helper -8.125 PRECISION))
(define p36 (build-truncated-float-helper 36 PRECISION))
(define n46.552 (build-truncated-float-helper -46.552 PRECISION))
(define n6.3 (build-truncated-float-helper -6.3 PRECISION))
(define n28.35 (build-truncated-float-helper -28.35 PRECISION))
(define pi (build-truncated-float-helper 3.14 PRECISION))
(define 100pi (build-truncated-float-helper 314 PRECISION))
(define n100pi (build-truncated-float-helper -314 PRECISION))
(define p1.0001 (build-truncated-float-helper 1.0001 PRECISION))
(define p4.14 `(0 ,(build-num 129) ( 0 1 0 1  1 1 1 0  0 0 1 0  0 0 0 1)))
(define p414.15 `(0 ,(build-num 135) ( 0 0 0 0  0 0 0 0  1 1 1 1  0 0 1 1)))
(define p214 (build-truncated-float-helper 214 PRECISION))
(define n214 (build-truncated-float-helper -214 PRECISION))
(define p2.14 `(0 ,(build-num 128) ( 1 0 1 0  1 1 1 1  0 0 0 1  0 0 0 1)))
(define n2.14 `(1 ,(build-num 128) ( 1 0 1 0  1 1 1 1  0 0 0 1  0 0 0 1)))
(define p7850 `(0 ,(build-num 139) ( 0 0 0 0 1 0 1 0 1 0 1 0 1 1 1 1)))
(define p125 `(0 ,(build-num 133) ( 0 0 0 0 0 0 0 0 0 1 0 1 1 1 1 1)))
(define p20 `(0 ,(build-num 131) ( 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1)))
(define 20pi (build-truncated-float-helper 62.8 PRECISION))
(define p0.05 (build-truncated-float-helper 0.05 PRECISION))
(define n0.01 (build-truncated-float-helper -0.01 PRECISION))
(define n0.05 (build-truncated-float-helper -0.05 PRECISION))
(define n1.05 (build-truncated-float-helper -1.05 PRECISION))
(define p40 (build-truncated-float-helper 40 PRECISION))
(define n3 (build-truncated-float-helper -3 PRECISION))
(define n100 (build-truncated-float-helper -100 PRECISION))
(define p100.01 (build-truncated-float-helper 100.01 PRECISION))
(define n100.01 (build-truncated-float-helper -100.01 PRECISION))
(define p99.99 (build-truncated-float-helper 99.99 PRECISION))
(define n99.99 (build-truncated-float-helper -99.99 PRECISION))

(define p10 (build-truncated-float-helper 10 PRECISION))
(define p0.1 (build-truncated-float-helper 0.1 PRECISION))
(define p100 (build-truncated-float-helper 100 PRECISION))
(define p0.01 (build-truncated-float-helper 0.01 PRECISION))
(define p1000 (build-truncated-float-helper 1000 PRECISION))
(define p0.001 (build-truncated-float-helper 0.001 PRECISION))
(define p10000 (build-truncated-float-helper 10000 PRECISION))
(define p0.0001 (build-truncated-float-helper 0.0001 PRECISION))
(define p100000 (build-truncated-float-helper 100000 PRECISION))
(define p1000000 (build-truncated-float-helper 1000000 PRECISION))
(define p0.00001 (build-truncated-float-helper 0.00001 PRECISION))
(define p0.000001 (build-truncated-float-helper 0.000001 PRECISION))
(define p0.0000001 (build-truncated-float-helper 0.0000001 PRECISION))
(define p0.0625 (build-truncated-float-helper 0.0625 PRECISION))
